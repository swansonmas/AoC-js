/* 
	buildJSON = function(entries, key, keys, values)
	permute = function(a)
	permuteStr = function(s)
	combine = function(a, min, max)
	combineStr = function(s, min, max)
	transpose = function(matrix)
	OPTIONAL: findHash = function(k, t, l)
	Array => min,max,counts
*/
function day1(files) {
	var read1 = readlines(files);
	read1.then(function (strings) {
		var val1 = func1(strings);
		showDoneMessage("input1", "Part 1: ", val1);
	});
}

function day2(files) {
	var read2 = readlines(files);
	read2.then(function (strings) {
		var val2 = func2(strings);
		showDoneMessage("input2", "Part 2: ", val2);
	});
}

window.onload = function() {
	var lines = (input.match(/.+/g)||[]);
	
	var val1 = func1(lines);
	showDoneMessage("input1", "Part 1: ", val1);
	
	var val2 = func2(lines);
	showDoneMessage("input2", "Part 2: ", val2);
}

function findStart(topRow) {
	return topRow.indexOf(vert);
}

function inRange(mz, row, col) {
	return ((row > 0 && row < mz.length && col > 0 && col < mz[0].length) && (mz[row][col] != blnk));
}

function step(mz, curRow, curCol, curDir, steps) {
	var nxtRow = curRow;
	var nxtCol = curCol;
	while (inRange(mz, nxtRow  + curDir[0], nxtCol + curDir[1]) && 
			(mz[nxtRow][nxtCol] == vert || mz[nxtRow][nxtCol] == horz)) {
		nxtRow = nxtRow + curDir[0];
		nxtCol = nxtCol + curDir[1];
		steps++;
	}
	
	return [nxtRow, nxtCol, steps];
}

function turnMz(mz, curRow, curCol, curDir) {
	if (inRange(mz, curRow + curDir[1], curCol + curDir[0]) && mz[curRow + curDir[1]][curCol + curDir[0]] != blnk) {
		return [curDir[1], curDir[0]];
	} else {
		return [curDir[1]*(-1), curDir[0]*(-1)];
	}
}

function walkMaze(mz) {
	var str = '';
	var cr = 1,
		cc = findStart(mz[0]),
		stps = 1;
		pr = null,
		pc = null,
		dir = [1,0];
	while( !(pr == cr && pc == cc) && inRange(mz,cr,cc) ) {
		stps++;
		pr = cr;
		pc = cc;
		[cr,cc,stps] = step(mz,cr,cc,dir,stps)
		if (mz[cr][cc] != turn) {
			str = str.concat(mz[cr][cc]);
			cr += dir[0];
			cc += dir[1];
		} else {
			dir = turnMz(mz,cr,cc,dir);
			cr += dir[0];
			cc += dir[1];
		}
	}
	
	return [str, stps];
}


//	1:01:06
function func1(strs) {
	strs = strs.map( (line) => line.split("") );//.match(/\w+|\d+/g).map( wrd => wrd));//parseInt(line, 10));//
	console.log(strs);
	
	var [mze,] = walkMaze(strs);
	
	return mze;
}

//	1:07:10
function func2(strs) {
	strs = strs.map( (line) => line.split("") );//.match(/\w+|\d+/g).map( wrd => wrd));//parseInt(line, 10));//
	console.log(strs);
	
	var [,stps] = walkMaze(strs);
	
	return stps;
}

var turn = '+';
var vert = '|';
var horz = '-';
var blnk = ' ';
var input2 = `     |          
     |  +--+    
     A  |  C    
 F---|----E|--+ 
     |  |  |  D 
     +B-+  +--+ 
`;
var input = `                                                                                                                                                                             |                           
       +-------+             +---+                                         +-------------+           +-+   +---------+ +---------------------------------------------------------+ +-+     +---+         
       |       |             |   |                                         |             |           | |   |         | |                                                     |   | | |     |   |         
 +-----|-------+     +-------|-----+                                       +-------+ +-+ +-----------|-|---|---------|-----------------+ +---------------------------------------+ | +-----|---|-------+ 
 |     |             |       |   | |                                               | | |             | |   |         | |               | |                                   |     |       |   |       | 
 |     |             |       |   | |       +-----------+                         +---+ |         +---|-|-------------|-|---------------+ +---+                               |     |     +---+ |       | 
 |     |             |       |   | |       |           |                         | |   |         |   | |   |         | |                     |                               |     |     | | | |       | 
 |     |             |       |   | |       +-----------------------+             | |   |         |   | |   |         | |                     |                               |     |     | | | |       | 
 |     |             |       |   | |                   |           |             | |   |         |   | |   |         | |                     |                               |     |     | | | |       | 
 |     |             |       |   | |     +-------+     |   +-------|-----------------------------|---+ | +-|-------+ | |                   +-----+                           |     |     | | | |       | 
 |     |             |       |   | |     |       |     |   |       |             | |   |         |     | | |       | | |                   | |   |                           |     |     | | | |       | 
 |     |             |       |   | |     |       |     |   |       +-------------|-|---|---------|-------|---------|---|---------------------|---|-------+   +---------------|-----------|-+ | |       | 
 |     |             |       |   | |     |       |     |   |                     | |   |         |     | | |       | | |                   | |   |       |   |               |     |     |   | |       | 
 |     |             |       |   | |     |   +---------|-------------------------|-----|---------|---------|---------|-----------------------|---------------|-----------+   |   +-------------|-----+ | 
 |     |             |       |   | |     |   |   |     |   |                     | |   |         |     | | |       | | |                   | |   |       |   |           |   |   | |     |   | |     | | 
 |     |             |       |   +-|-------+ +-----+   |   |           +-----------|---|---------------|-----------|-+ |                   | |   |       |   |           |   |   | |     |   +-----+ | | 
 |     |             |       |     |     | |     | |   |   |           |         | |   |         |     | | |       |   |                   | |   |       |   |           |   |   | |     |     |   | | | 
 +---+ +-------------|-------------------|-+     | |   |   |           |         | |   |         |     | | |   +---|-----------------------|-|-----------------------------------|-----------+ |   | | | 
     |               |       |     |     |       | |   |   |           |         | |   |         |     | | |   |   |   |                   | |   |       |   |           |   |   | |     |   | |   | | | 
     +-+             |   +-----+ +-------|R--------|---------+         |         | |   |         +-----|---|---|-------|-----------------------------------------------+ | +-|---|-------|-+ | |   | +-+ 
       |             |   |   | | | |     |       | |   |   | |         |         | |   |               | | |   |   |   |                   | |   |       |   |         | | | |   | |     | | | |   |     
       |             | +-|-+ | | +-|-----|---+   | |   +---+ | +-----------------|-----|-------------------|-------|-------+               | |   |       |   +-------------------|-|-----|-----|-------+ 
       |             | | | | | |   |     |   |   | |         | |       |         | |   |               | | |   |   |   |   |               | |   |       |             | | | |   | |     | | | |   |   | 
       |             | | +---|-|---------|-------|-----------|-|-----------------|-|---+               | | |   |   |   |   |               | |   |   +-------+         | | | |   | |   +---|---------+ | 
       |             | |   | | |   |     |   |   | |         | |       |         | |                   | | |   |   |   |   |               | |   |   |   |   |         | | | |   | |   | | | | |   | | | 
       |             | |   | | |   |     |   |   | |         | |       |         | |   +---------------|---|-----------|---+               | |   |   |   |   |         | | | |   | |   | | | | |   | | | 
       |             | |   | | |   |     |   |   | |         | |       |         | |   |               | | |   |   |   |                   | |   |   |   |   |         | | | |   | |   | | | | |   | | | 
   +-+ | +---+       | |   | | |   |     |   |   | |     +-----|-----------------|-|---|-------+       | | |   |   |   |                   | |   |   |   |   |         | | | |   | |   | | | | |   | | | 
   | | | |   |       | |   | | |   |     |   |   | |     |   | |       |         | |   |       |       | | |   |   |   |                   | |   |   |   |   |         | | | |   | |   | | | | |   | | | 
   | | | |   |       | |   | | |   |     |   |   | |   +-|---|---------------------|-------+   |       +-|-|---|-------------------+       | |   |   |   | +-----+ +---+ | | |   | |   | | | | |   | | | 
   | | | |   |       | |   | | |   |     |   |   | |   | |   | |       |         | |   |   |   |         | |   |   |   |           |       | |   |   |   | | |   | |     | | |   | |   | | | | |   | | | 
   | +-|-------------------|---|---------|-------+ |   | | +-|---------------+   | |   |   |   |         | |   |   |   |           |       | |   |   |   | | |   | |     | | |   | |   | | | | |   | | | 
   |   | |   |       | |   | | |   |     |   |     |   | | | | |       |     |   | |   |   |   |         | |   |   |   |           |       | |   |   |   | | |   | |     | | |   | |   | | | | |   | | | 
   |   | |   |       | |   | | |   |     |   |     |   | | | | +-------|---------|---------+   |         | |   |   |   |           |       | | +-|---|-----------|-|-----|-------+ |   | | | | |   | | | 
   |   | |   |       | |   | | |   |     |   |     |   | | | |         |     |   | |   |       |         | |   |   |   |           |       | | | |   |   | | |   | |     | | |     |   | | | | |   | | | 
 +-|-+ | |   |       | |   | | |   |     |   |     |   | | | |         |     |   | |   |       |         | |   |   |   |           |       | | | |   | +-|-+ | +-|-|-------------------|---|-+ |   | | | 
 | | | | |   |       | |   | | |   |     |   |     |   | | | |         |     |   | |   |       |         | |   |   |   |           |       | | | |   | | |   | | | |     | | |     |   | | |   |   | | | 
 | | +---|-------------|---|---+   |     |   |     |   | +-+ |         |     |   | |   |       |         | |   |   |   |           |       | | | |   | | |   | | | |     | | |     |   | | |   |   | | | 
 | |   | |   |       | |   | |     |     |   |     |   |     |         |     |   | |   |       |         | |   |   |   |           |       | | | |   | | |   | | | |     | | |     |   | | |   |   | | | 
 | |   | |   |       | |   | |     |     |   |     | +-------|---------|-----|---|-|----I------------------|---+   |   |           |       | | | |   | | |   | | | |     | | |     |   | | |   |   | | | 
 | |   | |   |       | |   | |     |     |   |     | | |     |         |     |   | |   |       |         | |       |   |           |       | | | |   | | |   | | | |     | | |     |   | | |   |   | | | 
 | |   | |   |   +---|-----|-----+ |     +---|---+ | | |     |     +---|-----|---------|-----------------|---------------------------------|-|-|-----|---------|---------|-|---+   |   | | |   |   | | | 
 | |   | |   |   |   | |   | |   | |         |   | | | |     |     |   |     |   | |   |       |         | |       |   |           |       | | | |   | | |   | | | |     | | | |   |   | | |   |   | | | 
 | | +-------|---|-----|---|-----|-----------|---|-|---|---------------|-----|---------|-----------------|-|-----------|---------------------|-+ |   | | |   | | | |     | | | |   |   | | |   |   | | | 
 | | | | |   |   |   | |   | |   | |         |   | | | |     |     |   |     |   | |   |       |         | |       |   |           |       | |   |   | | |   | | | |     | | | |   |   | | |   |   | | | 
 | | | | |   |   |   | |   | |   | |         |   | | | |     |     |   |     |   | |   |       |         | |       |   |           |       | |   |   | | | +---|-|---------|-------|-+ | | |   |   | | | 
 | | | | |   |   |   | |   | |   | |         |   | | | |     |     |   |     |   | |   |       |         | |       |   |           |       | |   |   | | | | | | | |     | | | |   | | | | |   |   | | | 
 | | | | |   |   |   | |   | |   | |         |   | | | |     |     |   |     |   | |   |       |         | |       |   |           |       | |   |   | | | +-|-|-+ |     | | | |   | | | | |   |   | | | 
 | | | | |   |   |   | |   | |   | |         |   | | | |     |     |   |     |   | |   |       |         | |       |   |           |       | |   |   | | |   | |   |     | | | |   | | | | |   |   | | | 
 | | | | |   |   |   | |   | |   | |         |   | | | |     |     |   |     |   | |   |       +-----------|---------------------------------|-------+ | |   | |   |     | | | |   | | | | |   |   | | | 
 | | | | |   |   |   | |   | |   | |         |   | | | |     |     |   |     |   | |   |                 | |       |   |           |       | |   |     | |   | |   |     | | | |   | | | | |   |   | | | 
 | +-|-|---------------|-----|-----|---------|-------|-----------------------|---------|-----------------|-|-------|---------------|-------------------|-+   | |   |     | | | |   | | | | |   |   | | | 
 |   | | |   |   |   | |   | |   | |         |   | | | |     |     |   |     |   | |   |                 | |       |   |           |       | |   |     |     | |   |     | | | |   | | | | |   |   | | | 
 |   | | |   |   | +---------|---+ |         +-----|-|-----------------|-----|---------------------------|-|-----------------------|---------|---|-----|-----|---+ |     | | | |   | | | | |   |   | | | 
 |   | | |   |   | | | |   | |     |             | | | |     |     |   |     |   | |   |                 | |       |   |           |       | |   |     |     | | | |     | | | |   | | | | |   |   | | | 
 |   | | |   |   | | | |   | |     |             | | | |     |     |   |     |   | |   |                 | |       |   |           |       +-|---|-----------|-----------------|-----------|-----+ | | | 
 |   | | |   |   | | | |   | |     |             | | | |     |     |   |     |   | |   |                 | |       |   |           |         |   |     |     | | | |     | | | |   | | | | |   | | | | | 
 |   | | |   |   | | | |   +-|-------+           | | | |     |     |   |     |   | |   |                 | |       |   |           |         |   |     |     | | | |     | | | |   | | | | |   | | | | | 
 |   | | |   |   | | | |     |     | |           | | | |     |     |   |     |   | |   |                 | |       |   |           |         |   |     |     | | | |     | | | |   | | | | |   | | | | | 
 |   +--C----|-------|-------|-----|-|-----------|-|-|-+     |     |   |     |   | |   |         +---------|-------|-----------------------------------|-----|-|-|-|-+   | | | |   | | | | |   | | | | | 
 |     | |   |   | | | |     |     | |           | | |       |     |   |     |   | |   |         |       | |       |   |           |         |   |     |     | | | | |   | | | |   | | | | |   | | | | | 
 |     +-|---|-------|-|-----|-----|-------------|-|---+     |     |   |     |   | |   |         |       | |       |   |           |         |   |   +-|-----|---|-|-|---|---------|-----|-+   | | | | | 
 |       |   |   | | | |     |     | |           | | | |     |     |   |     |   | |   |         |       | |       |   |           |         |   |   | |     | | | | |   | | | |   | | | |     | | | | | 
 |       |   |   | | | |     |     | |         +-|-|---|-----------|-------------|-|---|-----------------|---------|---------------|-----------------|-|---------|-+ |   | | | |   | | | |     | | | | | 
 |       |   |   | | | |     |     | |         | | | | |     |     |   |     |   | |   |         |       | |       |   |           |         |   |   | |     | | |   |   | | | |   | | | |     | | | | | 
 |       |   |   | | | |     |     | |         | | | | |     |     |   |     |   | |   |         |       | |       |   |           | +-----------|-----|-----|-----------+ | | |   | | | |     | | | | | 
 |       |   |   | | | |     |     | |         | | | | |     |     |   |     |   | |   |         |       | |       |   |           | |       |   |   | |     | | |   |     | | |   | | | |     | | | | | 
 |       |   |   | | | |     |     | |         | | | | |     |     |   |     |   | |   |         |       | |       |   |           | |       |   |   | |     | | |   |     | | |   | | | |     | | | | | 
 |       |   |   | | | |     |     | |         | | | | |     |     |   |     |   | |   |         |       | |       |   |           | |       |   |   | |     | | |   |     | | |   | | | |     | | | | | 
 |       |   |   | | | |     |     | |         | | | | |     |     |   |     |   | |   |         |       | |       |   |           | |       |   |   | |     | | |   |     | | |   | | | |     | | | | | 
 |       |   |   | | | |     |     | |         | | | | |     |     |   |     |   | |   |         |       | |       |   |           | |       |   |   | |     | | |   |     | | |   | | | |     | | | | | 
 +-----------|-------|-|-------------|---------|-------------------|---|---------|-----|-----------------------+ +-|-------------------------|---|---|-----------|-+ |     | | |   | | | |     | | | | | 
         |   |   | | | |     |     | |         | | | | |     |     |   |     |   | |   |         |       | |   | | |   |           | |       |   |   | |     | | | | |     | | |   | | | |     | | | | | 
 +---------------------|-----|-----------------|-|-|-|-------|-----------+   +---------------------------|-+   | | |   |           +---------|---|---|-|-----|-|---+ +---------|---|-|-|-|---+ | | | | | 
 |       |   |   | | | |     |     | |         | | | | |     |     |   | |       | |   |         |       |     | | |   |             |       |   |   | |     | | |         | | |   | | | |   | | | | | | 
 |       |   |   | | | |     |   +---|---------|---|-|-------------|---|-|-------------|-----------------------|-------|-------------|-------|-------------------|---------|-|-+   | | | |   | | | | | | 
 |       |   |   | | | |     |   | | |         | | | | |     |     |   | |       | |   |         |       |     | | |   |             |       |   |   | |     | | |         | |     | | | |   | | | | | | 
 | +-----------+ | | | |     |   | | |         | | | | |     |     |   +---------|-----|-------------------------|-------------------------+ |   |   | |     | | |         | +-+   | | | |   | | | | | | 
 | |     |   | | | | | |     |   | | |         | | | | |     |     |     |       | |   |         |       |     | | |   |             |     | |   |   | |     | | |         |   |   | | | |   | | | | | | 
 | |     |   | | | | | |     |   | +-------------|-|-|-----------------------------|-------------|---------+   | | |   |             |     +-|---|-----|-------------------|---------|-|-----|-----+ | | 
 | |     |   | | | | | |     |   |   |         | | | | |     |     |     |       | |   |         |       | |   | | |   |             |       |   |   | |     | | |         |   |   | | | |   | | |   | | 
 | |     |   | | | | | |     |   +-------------|---|---|-----|-----|-----|-----+ | |   |         |       | | +-+ | |   |             |       |   |   | |     | | |         |   |   | | | |   | | |   | | 
 | |     |   | | | | | |     |       |         | | | | |     |     |     |     | | |   |         |       | | |   | |   |             |       |   |   | |     | | |         |   |   | | | |   | | |   | | 
 | |     |   | | | | | |     |       |         | | | | |     |     |     |     | | |   |         |     +---|-------------------------------------------------|-|-|---------|-------|-+ | |   | | |   | | 
 | |     |   | | | | | |     |       |         | | | | |     |     |     |     | | |   |         |     | | | |   | |   |             |       |   |   | |     | | |         |   |   |   | |   | | |   | | 
 | |   +-------|---|-------------+   |         +-|---+ |     |     |     |     | | |   | +-------------|---------|-----|-------------------------|---|-------|-|-|---+     |   |   |   | |   | | |   | | 
 | |   | |   | | | | | |     |   |   |           | |   |     |     |     |     | | |   | |       |     | | | |   | |   |             |       |   |   | |     | | |   |     |   |   |   | |   | | |   | | 
 | | +---|---|-|-|-|-|-|-----|-------|-------------|---|-----------------|-----|-------|-|-------------|-|-|-----|-|-----------------|-------|---|-----+     +-|-|---------|---|-------|---------|-+ | | 
 | | | | |   | | | | | |     |   |   |           | |   |     |     |     |     | | |   | |       |     | | | |   | |   |             |       |   |   |         | |   |     |   |   |   | |   | | | | | | 
 | | | | |   | | | | | |     |   +---|-----------|-|---------------------------|-|-----|-|---------------|-|-|-----|---+             |       |   |   |         | |   |     |   |   |   | |   | | | | | | 
 | | | | |   | | | | | |     |       |           | |   |     |     |     |     | | |   | |       |     | | | |   | |                 |       |   |   |         | |   |     |   |   |   | |   | | | O | | 
 | | | | | +-|---|-------------------|-----------|-----|-----|-----|---------+ | | |   | |       |     | | | |   | |   +---------+   |       |   |   |         | |   |     |   |   |   | |   | | | | | | 
 | | | | | | | | | | | |     |       |           | |   |     |     |     |   | | | |   | |       |     | | | |   | |   |         |   |       |   |   |         | |   |     |   |   |   | |   | | | | | | 
 +-+ | | | | | | | | | |     |       |           | |   |     |     |     |   | | | |   | |       |     | | +-|---------|---------------------|---|---|---------|-|---|-----|---|-------|------Q--|---+ | 
     | | | | | | | | | |     |       |           | |   |     |     |     |   | | | |   | |       |     | |   |   | |   |         |   |       |   |   |         | |   |     |   |   |   | |   | | | |   | 
 +-------------|-|---+ |     |       |           | |   |     |     |     |   | | | |   | |       |     | |   |   | |   +-------------|---------------+         | |   |     |   +---|---|-|---|-----|-+ | 
 |   | | | | | | | |   |     |       |           | |   |     |     |     |   | | | |   | |       |     | |   |   | |             |   |       |   |             | |   |     |       |   | |   | | | | | | 
 |   | | | | | | | |   |     |       |           | |   |     |     |     |   | | | |   | |       |     | |   |   | |             |   |       |   |         +---|-|-------------+   |   | |   | | | | | | 
 |   | | | | | | | |   |     |       |           | |   |     |     |     |   | Y | |   | |       |     | |   |   | |             |   |       P   |         |   | |   |     |   |   |   | |   | | | | | | 
 |   | | | | | | | |   |     |       |           | |   |     |     |     |   | | | |   | |       |     | |   |   | |         +-------|-------|---|-------+ |   | |   |     |   +-----+ | |   | | | | | | 
 |   | | | | | | | |   |     |       |           | |   |     |     |     |   | | | |   | |       |     | |   |   | |         |   |   |       |   |       | |   | |   |     |       | | | |   | | | | | | 
 |   | | | | | | | |   |     |       |           | |   |     |     |     |   | | | |   | |       |     | |   |   | |         |   |   |       |   |       | |   | |   |     |       | | | |   | | | | | | 
 |   | | | | | | | |   |     |       |           | |   |     |     |     |   | | | |   | |       |     | |   |   | |         |   |   |       |   |       | |   | |   |     |       | | | |   | | | | | | 
 |   | | | | | | | |   |     |       |           | |   |     |     |     |   | | | |   | |       |     | |   |   | |         |   |   |       |   |       | |   | |   |     |       | | | |   | | | | | | 
 |   | | | | | | | |   |     |       |           | |   |     |     |     |   | | | |   | |       |     | |   |   | |         |   |   |       |   |       | |   | |   |     |       | | | |   | | | | | | 
 |   | | | | | | | |   |     |       |           | |   |     | +---------|---|---------|-----------------|---|-------------------|---|-----------|-------|-+   | |   |     |       | | | |   | | | | | | 
 |   | | | | | | | |   |     |       |           | |   |     | |   |     |   | | | |   | |       |     | |   |   | |         |   |   |       |   |       |     | |   |     |       | | | |   | | | | | | 
 |   | | | | | | | |   |     |       |           | |   |     | |   |     |   | | | |   | |       |     | |   |   | |         |   |   |       |   |       |     | |   |     |       | | | |   | | | | | | 
 |   | | | | | | | |   |     |       |           | |   |     | |   |     |   | | | |   | |       |     | |   |   | |         |   |   |       |   |       |     | |   |     |       | | | |   | | | | | | 
 |   | | | | | | | |   |     |       |           | +---|-----|-----|-------------|-|-----|-------|-----|-----|---|---------+ |   |   |       |   |       |     | |   |     |       | | | |   | | | | | | 
 |   | | | | | | | |   |     |       |           |     |     | |   |     |   | | | |   | |       |     | |   |   | |       | |   |   |       |   |       |     | |   |     |       | | | |   | | | | | | 
 +---|-|-|-|-|---|-|-+ |     |       |           |     |     | |   |     |   | | | |   | |       |     | |   |   | |   +---|-+   +---|-------|---|-------------------|-------+     | | | |   | | | | | | 
     | | | | | | | | | |     |       |           |     |     | |   |     |   | | | |   | |       |     | |   |   | |   |   |         |       |   |       |     | |   |     | |     | | | |   | | | | | | 
 +---|-|---|-|-|-|-|---------|-------|-----------------|-----|---------------+ | | |   | |       |     | |   |   +-|---+   |         +-----------|-------|-----|---------+ | +---------|-------|-|-+ | | 
 |   | | | | | | | | | |     |       |           |     |     | |   |     |     | | |   | |       |     | |   |     |       |                 |   |       |     | |   |   | |       | | | |   | | |   | | 
 |   | | | | | | | | | |     |       |           |     |     | |   |     |     | | |   | |       |     | |   |     |       |                 +-----------|-+   | |   |   | |       | | | |   | | |   | | 
 |   | | | | | | | | | |     |       |           |     |     | |   |     |     | | |   | |       |     | |   |     |       |                     |       | |   | |   |   | |       | | | |   | | |   | | 
 |   | | | | | | | | | |     |       |           |     |     | |   |     | +---|-|-------|-------|-----|-+   |     |       |                     |       | |   | |   |   | |       | | | |   | | |   | | 
 |   | | | | | | | | | |     |       |           |     |     | |   |     | |   | | |   | |       |     |     |     |       |                     |       | |   | |   |   | |       | | | |   | | |   | | 
 |   | | | | | | | | | |     |       |           |     |     | |   |     | |   | | |   | |       |     |     |     |       |         +-------------------|-|---------|-----------------|-|-------|-+ | | 
 |   | | | | | | | | | |     |       |           |     |     | |   |     | |   | | |   | |       |     |     |     |       |         |           |       | |   | |   |   | |       | | | |   | | | | | | 
 |   | | | | | | | | | |     |     +-------------------|-----|-------------|-------|-------------|-----|-----|-----------------------|-----------|-------|-|-----|-------|-|-----+ | | | |   | | | | +-+ 
 |   | | | | | | | | | |     |     | |           |     |     | |   |     | |   | | |   | |       |     |     |     |       |         |           |       | |   | |   |   | |     | | | | |   | | | |     
 |   | | | | | | | | | |     |     | |           |     |     | |   |     | +---+ | |   | |       |     |     |     |       |         |           |       | |   | |   |   | |     | | | | |   | | | |     
 |   | | | | | | | | | |     |     | |           |     |     | |   |     |       | |   | |       |     |     |     |       |         |           |       | |   | |   |   | |     | | | | |   | | | |     
 |   | | | | | | | | | |     |     | |           |     |     | |   |     |       | +-----|-------------------|-----------------------------------+       | |   | |   |   | |     | | | | |   | | | |     
 |   | | | | | | | | | |     |     | |           |     |     | |   |     |       |     | |       |     |     |     |       |         |                   | |   | |   |   | |     | | | | |   | | | |     
 |   | | | | | | | | | |     |     | |           |     |     | | +-|-------------|---------------|-----------|-----|---------------+ |                   | |   | |   |   | |     | | | | |   | | | |     
 |   | | | | | | | | | |     |     | |           |     |     | | | |     |       |     | |       |     |     |     |       |       | |                   | |   | |   |   | |     | | | | |   | | | |     
 |   | | | | | | | | | |     |     | |           |     |     | | | +-----+       |     | |       |     |     |   +-|-----------+   | |               +-----|---|-----+   | |     | | | | |   | | | |     
 |   | | | | | | | | | |     |     | |           |     |     | | |               |     | |       |     |     |   | |       |   |   | |               |   | |   | |       | |     | | | | |   | | | |     
 |   | +---------|-----------|-------|-----------------|---+ | | |               |     | |       |     |     |   | |       |   |   | |   +---------------|-|---|---------|-|-+   | +-+ | |   | | | |     
 |   |   | | | | | | | |     |     | |           |     |   | | | |               |     | |       |     |     |   | |       |   |   | |   |           |   | |   | |       | | |   |     | |   | | | |     
 |   |   | | | | +-----|-----------|-----------------------|-|---|-------+       |     | |       |     |     |   | |       |   |   | |   |           |   | +---|-|-------|-------------|-----------|-+   
 |   |   | | | |   | | |     |     | |           |     |   | | | |       |       |     | |       |     |     |   | |       |   |   | |   |           |   |     | |       | | |   |     | |   | | | | |   
 |   |   | | | |   | | |     |     | |           |     |   | | | |       |       |     | |       |     |     +-----|-----------|---|---------------------------+ |       | | |   |     | |   | | | | |   
 |   |   | | | |   | | |     |     | |           |     |   | | | |       |       |     | |       |     |         | |       |   |   | |   |           |   |       |       | | |   |     | |   | | | | |   
 |   |   | | | |   | | |     |     | |           |     |   | | | |       |       |     | |       |     |         | |       |   |   | |   |           |   |       |       | | |   |     | |   | | | | |   
 |   |   | | | |   | | |     |     | |           |     |   | | | |       |       |     | |       |     |         | |       |   |   | |   |           |   |       |       | | |   |     | |   | | | | |   
 |   | +---|---|-------------|-----|---------------------------+ |       |       |     | |       |     |         | |       |   |   | |   |           |   |       |       | | |   |     | |   | | | | |   
 |   | | | | | |   | | |     |     | |           |     |   | |   |       |       |     | |       |     |         | |       |   |   | |   |           |   |       |       | | |   |     | |   | | | | |   
 |   | | | | | |   | | |     |     | |           |     |   | |   |       |       |     | |       |     |         | |       |   |   | |   |           |   |       |       | | |   |     | |   | | | | |   
 |   | | | | | |   | | |     |     | |           |     |   | |   |       |       |     | |       |     |         | |       |   |   | |   |           |   |       |       | | |   |     | |   | | | | |   
 |   | | | | | |   | | |     |     | |           |     |   | |   |     +-|-------|-------|-------------+         | |       |   |   | |   |           |   |       |       | | |   | +---|-|---|---|---+   
 |   | | | | | |   | | |     |     | |           |     |   | |   |     | |       |     | |       |               | |       |   |   | |   |           |   |       |       | | |   | |   | |   | | | |     
 |   | | | | | |   | | |     |     | |           |     |   | +---------|---------------|-|-------|---------------|-------------------|---+           |   |       |       | | |   | |   | |   | | | |     
 |   | | | | | |   | | |     |     | |           |     |   |     |     | |       |     | |       |               | |       |   |   | |               |   |       |       | | |   | |   | |   | | | |     
 |   | | | | | |   | | |     |   +--------L------------|-----+   |     | +-+     |     | |       |               +---------|---|---------------------------------|---------+ |   | |   | |   | | | |     
 |   | | | | | |   | | |     |   | | |           |     |   | |   |     |   |     |     | |       |                 |       |   |   | |               |   |       |       |   |   | |   | |   | | | |     
 | +-|-|-|-|-|-----|---|-----|---|-|-+           +---------|-----|---------------|-----|---------|-----------------|-----------+   | |               |   |       |       |   |   | |   | |   | | | |     
 | | | | | | | |   | | |     |   | |                   |   | |   |     |   |     |     | |       |                 |       |       | |               |   |       |       |   |   | |   | |   | | | |     
 | | +-|-----|-----+ | |     |   | | +-------+         |   | |   |     |   |     |     | |       |                 |       |       | |               |   |       |       |   |   | |   | |   | | | |     
 | |   | | | | |     | |     |   | | |       |         |   | |   |     |   |     |     | |       |                 |       |       | |               |   |       |       |   |   | |   | |   | | | |     
 | +-----+ | | | +-----|-----|---|---|---------------------|---------------|-----|-------|-------|-----------------|-------|-------+ |               |   |       |       |   |   | |   | |   | | | |     
 |     |   | | | |   | |     |   | | |       |         |   | |   |     |   |     |     | |       |                 |       |         |               |   |       |       |   |   | |   | |   | | | |     
 |     |   | | | |   | | +---|-----+ +-------|---------|-----|---------+   |     |     | |       |                 |       |         |               |   |       |       |   |   | |   | |   | | | |     
 |     |   | | | |   | | |   |   |           |         |   | |   |         |     |     | |       |                 |       |         |               |   |       |       |   |   | |   | |   | | | |     
 | +-------+ | | |   | | |   |   +-----+     |         |   | |   |     +---|-----------|---------|-----------------------------------|-------------------|-------+       |   |   | |   | |   | | | |     
 | |   |     | | |   | | |   |         |     |         |   | |   |     |   |     |     | |       |                 |       |         |               |   |               |   |   | |   | |   | | | |     
 | |   |     | | |   | | |   |         |     |         |   | |   |     |   |     |     | |       |                 |       |         |               |   |               |   |   | |   | |   | | | |     
 | |   |     | | |   | | |   |         |     |         |   | |   |     |   |     |     | |       |                 |       |         |               |   |               |   |   | |   | |   | | | |     
 | |   |     | | |   | | |   |         |     |         |   | |   |     |   |     |     | |       |       +-----------------|---------|-------------------|-------------------|-+ | |   | |   | | | |     
 | |   |     | | |   | | |   |         |     |         |   | |   |     |   |     |     | |       |       |         |       |         |               |   |               |   | | | |   | |   | | | |     
 | |   |     | | |   | | |   |     +---|---------------|---|-----------|-------+ |     | |       |       |         |       |         |               |   |           +-----+ | | | |   | |   | | | |     
 | |   |     | | |   | | |   |     |   |     |         |   | |   |     |   |   | |     | |       |       |         |       |         |               |   |           |   | | | | | |   | |   | | | |     
 +-----------|-|-----|-|-----|---------|-----|-------------------|-----|---|-----------|-|---------------|---------|-------|-----------------------------|---------------+ | | | | |   | |   | +-----+   
   |   |     | | |   | | |   |     |   |     |         |   | |   |     |   |   | |     | |       |       |         |       |         |               |   |           |     | | | | |   | |   |   | | |   
   |   |     | | |   | | |   |     |   |     |         |   | |   |     |   |   | |     | |       |       |         |       |         |               |   |           |     | | | | |   | |   |   | | |   
   |   |     | | |   | | |   |     |   |     |         |   | |   |     |   |   | |     | |       |       |         |       |         |               |   |           |     | | | | |   | |   |   | | |   
   |   |     | | |   | | |   |     |   |     |         |   | |   |     |   |   | |     | |       |       |         |       |         |               |   |           |     | | | | |   | |   |   | | |   
   |   |     | | |   | | |   |     |   |     |         |   | |   |     |   |   | |     | |       |       |         |       |         |               |   |           |     | | | | |   | |   |   | | |   
 +-+   |     | +-+   | | |   |     |   |     |         |   | |   |     |   |   | +-----------------------|-----------------|-----------------------------------------------+ | | | |   | |   |   | | |   
 |     |     |       | | |   |     |   |     |         |   | |   |     |   |   |       | |       |       |         |       |         |               |   |           |       | | | |   | |   |   | | |   
 | +---+     |       | | |   |     |   |     |         |   | |   |     |   |   |       | |       |       |         |       |         |               |   |           |       | | | |   | |   |   | | |   
 | |         |       | | |   |     |   |     |         |   | |   |     |   |   |       | |       |       |         |       |         |               |   |           |       | | | |   | |   |   | | |   
 | +-------+ +---+   +-|-------+   |   |     |         |   | |   |     |   |   |       | |       |       |         |       |         |               |   +-+         |       | | | |   | |   |   | | |   
 |         |     |     | |   | |   |   |     |         |   | |   |     |   |   |       | |       |       |         |       |         |               |     |         |       | | | |   | |   |   | | |   
 |         +-----|-------|-------------|-----|-------------|-----|---------|-----------|-|---------------+         +-+     |         +---------------------|---------------------|-+   | |   |   | | |   
 |               |     | |   | |   |   |     |         |   | |   |     |   |   |       | |       |                   |     |                         |     |         |       | | |     | |   |   | | |   
 |             +-------+ |   | |   |   |     |         |   +-----|-----|---------------------------------------------|-----|-----------------+   +-------------------+     +-----+     | |   |   | | |   
 |             | |       |   | |   |   |     |         |     |   |     |   |   |       | |       |                   |     |                 |   |   |     |               | | |       | |   |   | | |   
 |     +-------+ |   +---|---|-|---|-----+   |         |     |   |     |   |   |       | |       |                   +-----+                 |   |   |     |               | | |       | |   +-+ | | |   
 |     |         |   |   |   | |   |   | |   |         |     |   |     |   |   |       | |       |                                           |   |   |     |               | | |       | |     | | | |   
 |     |       +-----+ +-----------------|---|-----------------------------|-----------|-----------------------------------------------------+   |   |     |               | | |       | |     | | | |   
 |     |       | |     | |   | |   |   | |   |         |     |   |     |   |   |       | |       |                                               |   |     |               | | |       | |     | | | |   
 |     |       | +-----+ |   | |   |   | |   |         |     |   |     |   |   |       | |       |                                   +-----------+   +---+ |               | | |       | |     | | | |   
 |     |       |         |   | |   |   | |   |         |     |   |     |   |   |       | |       |                                   |                   | |               | | |       | |     | | | |   
 +-------------+ +-----U +---------|---+ |   |         |     |   |     |   |   | +---------------------------------------------------|-------------------+ +---------------+ | |       | |     | | | |   
       |         |           | |   |     |   |         |     |   |     |   |   | |     | |       |                                   |                                       | |       | |     | | | |   
       |   +-----------------+ |   |     |   |         |     |   |     |   |   | |     | | +-----------------------------------------|---------------------------------------+ |       | |     | | | |   
       |   |     |             |   |     |   |         |     |   |     |   |   | |     | | |     |                                   |                                         |       | |     | | | |   
   +---+   |     +-----------------|-+   +---|---------|-----|---|-------------|-----+ | | +-----|-----------------------------------|---------------------------------------+ +-+     | |     +---+ +-+ 
   |       |                   |   | |       |         |     |   |     |   |   | |   | | |       |                                   |                                       |   |     | |       |     | 
 +---------+ +-----------------+   | +---+   |   +-----------+   +---------------+ +-+ +-|-+     | +-----------------------------------------------------------------------------------|-|-------|-----+ 
 | |         |                     |     |   |   |     |               |   |   |   |     | |     | |                                 |                                       |   |     | |       |       
 | +---+   +-|-------------------------------|-----------------------------|-------|-------------+ |                 +-------------------------------------------------------+ +-+     | |       |       
 |     |   | |                     |     |   |   |     |               |   |   |   |     | |       |                 |               |                                         |       | |       |       
 +---------+ +---------------------|-+   +---+   +-------------------------+   |   |     +-|-------|-----------------+               +-----------------------------------------+       | |       +-+     
       |                           | |                 |               |       |   |       |       |                                                                                   | |         |     
       +---------------------------+ +-----------------+               +-------+   +-------+       +-----------------------------------------------------------------------------------+ +---------+     
                                                                                                                                                                                                         `;